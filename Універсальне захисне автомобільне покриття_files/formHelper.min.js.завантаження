window.leadvertex || (window.leadvertex = {}), window.leadvertex.selling || (window.leadvertex.selling = {}), window.leadvertex.selling.delivery || (window.leadvertex.selling.delivery = {}), window.leadvertex.selling.discount || (window.leadvertex.selling.discount = {}), window.leadvertex.selling.price || (window.leadvertex.selling.price = {}), window.leadvertex.selling.quantity || (window.leadvertex.selling.quantity = 0), window.leadvertex.selling.additional || (window.leadvertex.selling.additional = {}), window.leadvertex.selling.additionalSum || (window.leadvertex.selling.additionalSum = 0), window.leadvertex.goods || (window.leadvertex.goods = {}), window.leadvertex.goods.added || (window.leadvertex.goods.added = {}), window.leadvertex.form = {}, window.leadvertex.form.label = function (e, a, t) {
    t ? 2 > t && (t = "") : t = "", lvjq1(document).ready((function () {
        lvjq1("label[for=lv-form" + t + "-" + e + "]").text(a)
    }))
}, window.leadvertex.form.subLabel = function (e, a, t) {
    t ? 2 > t && (t = "") : t = "", "update" == t && (t = "-update"), lvjq1(document).ready((function () {
        lvjq1("#lv-form" + t + " div.lv-row-" + e + ">.lv-field").after('<div class="lv-sub-label"><label for="lv-form' + t + "-" + e + '">' + a + "</label></div>")
    }))
}, window.leadvertex.form.buttonText = function (e, a) {
    a ? 2 > a && (a = "") : a = "", "update" == a && (a = "-update"), lvjq1(document).ready((function () {
        lvjq1("#lv-form" + a + " .lv-order-button").val(e)
    }))
}, window.leadvertex.form.placeholder = function (e, a, t) {
    t ? 2 > t && (t = "") : t = "", "update" == t && (t = ""), lvjq1(document).ready((function () {
        lvjq1("#lv-form" + t + "-" + e).attr("placeholder", a)
    }))
}, window.leadvertex.form.placeholderOnly = function (e) {
    e ? 2 > e && (e = "") : e = "", "update" == e && (e = "-update"), lvjq1(document).ready((function () {
        lvjq1("#lv-form" + e + " .lv-row.lv-row-input").each((function (e, a) {
            lvjq1(a).find(".lv-label").hide();
            var t = lvjq1(a).find(".lv-field > *");
            t.attr("placeholder", t.attr("data-label") + ("1" == t.attr("data-required") ? " *" : ""))
        }))
    }))
}, window.leadvertex.form.setTotal = function (e) {
    lvjq1(document).ready((function () {
        lvjq1(".lv-form-manual-total").val(e)
    }))
}, window.leadvertex.form.validation = function (e, a, t) {
    if (t) {
        var d = "";
        if (e.attr("data-validation-by-alert") || e.hasClass("lv2-form-validation-by-alert")) {
            for (var l in a) d += a[l][0] + "\n\n";
            alert(d)
        }
    } else e.trigger("lv-validated"), window.jQuery && jQuery(e).trigger("lv-validated");
    return !0
}, window.leadvertex.form.validationByAlert = function (e) {
    e ? 2 > e && (e = "") : e = "", "update" == e && (e = "-update"), lvjq1(document).ready((function () {
        var a = lvjq1("#lv-form" + e);
        a.attr("data-validation-by-alert", 1), a.find(".lv-error").hide()
    }))
}, window.leadvertex.form.showOnly = function (e, a) {
    a ? 2 > a && (a = "") : a = "", "update" == a && (a = "-update"), lvjq1(document).ready((function () {
        lvjq1("#lv-form" + a).find(".lv-row").each((function (a, t) {
            var d = lvjq1(t).attr("data-name"),
                l = -1 == lvjq1.inArray(d, e),
                o = lvjq1(t).attr("data-required");
            ("checkboxPersonalData" == d || "checkboxAgreeTerms" == d) && (lvjq1(t).prop("checked", !0), o = 0), l && 0 == o && lvjq1(t).hide()
        }))
    }))
}, window.leadvertex.form.goodAdd = function (e, a, t) {
    if (void 0 === window.leadvertex.goodsPrices) return !0;
    var d = ".lv-input-goods";
    "update" == e ? (e = "Update", d = "#lv-formLandingUpdate-goods") : (e = parseInt(e)) > 0 && (d = "#lv-formLanding" + e + "-goods");
    var l = 0;
    if (window.leadvertex.goodsPrices.hasOwnProperty(a)) {
        var o = window.leadvertex.goodsPrices[a],
            r = o.maxQuantity,
            n = o.prices;
        if (n[t]) l = n[t];
        else {
            var v = 0,
                i = 0;
            for (var s in n) n.hasOwnProperty(s) && (v = r > t && t > i ? i : r, i = s);
            l = parseInt(n[v] / v * t)
        }
    }
    window.leadvertex.goods.added = "" != lvjq1(d).val() ? JSON.parse(lvjq1(d).val()) : {}, window.leadvertex.goods.added[a] = {
        quantity: t,
        sum: l
    }, lvjq1(d).val(JSON.stringify(window.leadvertex.goods.added)), window.leadvertex.form.reCalcGoodForm(e)
}, window.leadvertex.form.goodRemove = function (e, a) {
    var t = ".lv-input-goods";
    "update" == e ? (e = "Update", t = "#lv-formLandingUpdate-goods") : (e = parseInt(e)) > 0 && (t = "#lv-formLanding" + e + "-goods"), window.leadvertex.goods.added = "" != lvjq1(t).val() ? JSON.parse(lvjq1(t).val()) : {}, window.leadvertex.goods.added[a] && delete window.leadvertex.goods.added[a], console.log(window.leadvertex.goods.added), lvjq1(t).val(JSON.stringify(window.leadvertex.goods.added)), window.leadvertex.form.reCalcGoodForm(e)
}, window.leadvertex.form.reCalcGoodForm = function (e) {
    lvjq1(".lv-good-price-total").each((function (a, t) {
        var d = parseInt(lvjq1(t).attr("data-lv-form"));
        if ("update" == d && (d = "Update"), d == e) {
            console.log(e);
            var l = "#lv-formLanding" + e + "-goods",
                o = 0,
                r = JSON.parse(lvjq1(l).val());
            for (var n in r) r.hasOwnProperty(n) && (o += parseInt(r[n].sum));
            lvjq1(t).text(o)
        }
    }))
}, lvjq1(document).ready((function () {
    function e() {
        for (var e in window.leadvertex.selling.additionalSum = 0, window.leadvertex.selling.additional) window.leadvertex.selling.additionalSum += parseInt(window.leadvertex.selling.additional[e]);
        return parseInt(window.leadvertex.selling.additionalSum)
    }

    function a() {
        var a = lvjq1(".lv-input-quantity"),
            t = window.leadvertex.selling.quantity;
        a.length > 0 && (t = parseInt(a.val()));
        var d, l = window.leadvertex.selling.delivery,
            o = window.leadvertex.selling.discount,
            r = parseInt(l.price);
        l.for_Each ? (d = r * t, lvjq1(".lv-delivery-price").text(d)) : d = r;
        var n = parseInt(window.leadvertex.selling.price.price) + e(),
            v = 0,
            i = !0,
            s = 0;
        if (o[t]) v = o[t].discount, i = o[t].round, s = o[t].sum;
        else {
            var w = -1;
            for (var u in o) {
                if (!(t >= u)) break;
                w = u
            } - 1 == w ? (v = 0, i = !0, s = 0) : (v = o[w].discount, i = o[w].round, s = 0)
        }
        var f = parseFloat(n * t / 100 * (100 - v)).toFixed(2);
        s > 0 && (f = s);
        var c = n * t - f;
        n = f, i && (n = Math.round(n)), lvjq1(".lv-quantity-discount-sum").text(parseInt(c)), lvjq1(".lv-quantity-discount-percent").text(parseInt(v)), lvjq1(".lv-total-price").each((function (e, a) {
            var t = $(a),
                l = parseInt(d) + parseInt(n),
                o = parseInt(t.attr("data-sum")),
                r = t.attr("data-operation"),
                v = parseInt(t.attr("data-percent"));
            switch (1 == v && (o = l / 100 * v), r) {
                case "+":
                    l += o;
                    break;
                case "-":
                    l -= o;
                    break;
                case "*":
                    l *= o;
                    break;
                case "/":
                    l /= o
            }
            t.text(parseInt(l))
        }))
    }

    function t(e, a, t, d, o, r) {
        window.leadvertex.goods.added = "" != lvjq1(d).val() ? JSON.parse(lvjq1(d).val()) : {}, window.leadvertex.goods.added[e] = {
            quantity: a,
            sum: t
        }, lvjq1(d).val(JSON.stringify(window.leadvertex.goods.added)), 1 == r && (o = ".lv2-form" + o, console.log(o), lvjq1(o).submit()), l(o)
    }

    function d(e, a, t) {
        window.leadvertex.goods.added = "" != lvjq1(a).val() ? JSON.parse(lvjq1(a).val()) : {}, window.leadvertex.goods.added[e] && delete window.leadvertex.goods.added[e], lvjq1(a).val(JSON.stringify(window.leadvertex.goods.added)), l(t)
    }

    function l(e) {
        lvjq1(".lv-good-price-total").each((function (a, t) {
            var d = parseInt(lvjq1(t).attr("data-lv-form"));
            if ("update" == d && (d = "Update"), d == e) {
                var l = "#lv-formLanding" + e + "-goods",
                    o = 0,
                    r = JSON.parse(lvjq1(l).val());
                for (var n in r) r.hasOwnProperty(n) && (o += parseInt(r[n].sum));
                lvjq1(t).text(o)
            }
        }))
    }
    lvjq1(".lv-move").each((function (e, a) {
        var t = lvjq1(a).attr("data-form");
        t && 1 != t || (t = ""), "update" == t && (t = "-update");
        var d = lvjq1(a).attr("data-position").toString().toLowerCase(),
            l = lvjq1(a).attr("data-field").toString().toLowerCase();
        l = "submit" == l ? "div.lv-form-submit" : "div.lv-row-" + l;
        var o = lvjq1("#lv-form" + t + " " + l);
        "before" == d && o.before(lvjq1(a)), "after" == d && o.after(lvjq1(a))
    })), 0 == lvjq1("#lv-form-update").length && lvjq1("#lv-update").hide(), lvjq1(".lv-order-form select").not(".lv-input-paymentOn").change((function () {
        lvjq1(".lv-order-form select." + lvjq1(this).attr("class")).val(lvjq1(this).val()), a()
    })), lvjq1(".lv-order-form select").not(".lv-input-quantity").not(".lv-input-paymentOn").change((function () {
        window.leadvertex.selling.additional[lvjq1(this).attr("class")] = lvjq1(this).find("option:selected").attr("data-sum"), lvjq1(".lv-multi-price").text(window.leadvertex.selling.price.price + e()), a()
    })), a(), lvjq1(".lv-good-button").click((function () {
        var e = lvjq1(this).attr("data-lv-alias"),
            a = lvjq1(this).attr("data-lv-add-text"),
            l = lvjq1(this).attr("data-lv-remove-text"),
            o = lvjq1(this).attr("data-lv-add-class"),
            r = lvjq1(this).attr("data-lv-remove-class"),
            n = lvjq1(this).attr("data-lv-add-remove"),
            v = lvjq1(this).attr("data-lv-price"),
            i = lvjq1(this).attr("data-lv-submit"),
            s = lvjq1(this).attr("data-lv-ajax"),
            w = ".lv-input-goods",
            u = lvjq1(this).attr("data-lv-form");
        switch ("update" == u ? (u = "Update", w = "#lv-formLandingUpdate-goods") : (u = parseInt(u)) > 0 && (w = "#lv-formLanding" + u + "-goods"), n) {
            case "add":
                lvjq1(this).text(l), lvjq1(this).attr("data-lv-add-remove", "remove"), lvjq1(this).removeClass(o), lvjq1(this).addClass(r), s ? function (e, a) {
                    var t = {};
                    t.form = a, t.alias = e, lvjq1.ajax({
                        url: "/order/addOrderGoods",
                        type: "post",
                        data: t,
                        success: function (e) {
                            "ok" == e && lvjq1("body").trigger("goodAdded")
                        }
                    })
                }(e, u) : t(e, 1, v, w, u, i);
                break;
            case "remove":
                lvjq1(this).text(a), lvjq1(this).attr("data-lv-add-remove", "add"), lvjq1(this).removeClass(r), lvjq1(this).addClass(o), s ? function (e, a) {
                    var t = {};
                    t.form = a, t.alias = e, lvjq1.ajax({
                        url: "/order/deleteOrderGoods",
                        type: "post",
                        data: t,
                        success: function (e) {
                            "ok" == e && lvjq1("body").trigger("goodRemoved")
                        }
                    })
                }(e, u) : d(e, w, u)
        }
    })), lvjq1(".lv-good-quantity").change((function () {
        var e = lvjq1(this).attr("data-lv-alias"),
            a = JSON.parse(lvjq1(this).attr("data-lv-prices")),
            l = parseInt(lvjq1(this).attr("data-lv-max-quantity")),
            o = parseInt(lvjq1(this).val()),
            r = ".lv-input-goods",
            n = lvjq1(this).attr("data-lv-form");
        if ("update" == n ? (n = "Update", r = "#lv-formLandingUpdate-goods") : (n = parseInt(n)) > 0 && (r = "#lv-formLanding" + n + "-goods"), o > 0)
            if (a[o]) t(e, o, a[o], r, n);
            else {
                var v = 0,
                    i = 0;
                for (var s in a) a.hasOwnProperty(s) && (v = l > o && o > i ? i : l, i = s);
                t(e, o, parseInt(a[v] / v * o), r, n)
            }
        else d(e, r, n)
    })), lvjq1(".lv-good-select").change((function () {
        var e = JSON.parse(lvjq1(this).attr("data-lv-prices")),
            a = lvjq1(this).val(),
            l = ".lv-input-goods",
            o = lvjq1(this).attr("data-lv-form");
        if ("update" == o ? (o = "Update", l = "#lv-formLandingUpdate-goods") : (o = parseInt(o)) > 0 && (l = "#lv-formLanding" + o + "-goods"), 0 != a) {
            if (e[a]) {
                for (var r in e) e.hasOwnProperty(r) && r != a && d(r, l, o);
                t(a, 1, e[a], l, o)
            }
        } else
            for (var n in e) e.hasOwnProperty(n) && d(n, l, o)
    }))
}));